   # Until https://github.com/docker/compose/issues/869 is implemented fig 
   # can't produce container names like glance_registry, so we are stuck with
   # glancereg and so have to use an alias in the links here so that
   # ultimately the *_PORT_*_TCP_ADDR env vars, e.g. 
   # GLANCE_REGISTRY_PORT_9191_TCP_ADDR, come out in a way that is usable by
   # fedora-rdo-base/service_hosts.sh

rabbitmq:
  image: imain/fedora-rdo-rabbitmq
  name: rabbitmq
  ports:
#   - "15672:15672"
    - "5672:5672"
  environment:
   - RABBITMQ_USER=guest
   - RABBITMQ_PASS=guest
mariadb:
  image: imain/fedora-rdo-mariadb
  name: mariadb
  ports:
   - "3306:3306"
   - "5000:5000"
  environment:
   - MYSQL_ROOT_PASSWORD=kolla
keystone:
  image: imain/fedora-rdo-keystone
  links:
   - mariadb
  environment:
   - MARIADB_SERVICE_HOST=10.18.57.121    
   - ADMIN_TENANT_NAME=admin
   - KEYSTONE_PUBLIC_SERVICE_HOST=10.18.57.121
   - KEYSTONE_DB_PASSWORD=kolla
   - KEYSTONE_ADMIN_PASSWORD=12345
   - KEYSTONE_ADMIN_TOKEN=12345
   - KEYSTONE_ADMIN_SERVICE_HOST=10.18.57.121
   - PUBLIC_IP=10.18.57.121
   - DB_ROOT_PASSWORD=kolla
glanceregistry:
  image: rthallisey/fedora-rdo-glance-registry
  environment:
   - ADMIN_TENANT_NAME=admin
   - GLANCE_DB_NAME=glance
   - GLANCE_DB_USER=glance
   - GLANCE_KEYSTONE_USER=glance
   - KEYSTONE_AUTH_PROTOCOL=httpd
   - KEYSTONE_PUBLIC_SERVICE_HOST=10.18.57.121
   - GLANCE_KEYSTONE_PASSWORD=glance
   - GLANCE_DB_PASSWORD=kolla
   - MARIADB_SERVICE_HOST=10.18.57.121
   - KEYSTONE_ADMIN_TOKEN=12345
   - KEYSTONE_ADMIN_SERVICE_HOST=10.18.57.121
   - PUBLIC_IP=10.18.57.121
   - DB_ROOT_PASSWORD=kolla
   - GLANCE_API_SERVICE_HOST=10.18.57.121
glanceapi:
  image: rthallisey/fedora-rdo-glance-api
  links:
   - keystone
   - glanceregistry:glance_registry 
   - rabbitmq
  environment:
   - ADMIN_TENANT_NAME=admin
   - GLANCE_DB_NAME=glance
   - GLANCE_DB_USER=glance
   - GLANCE_KEYSTONE_USER=glance
   - KEYSTONE_AUTH_PROTOCOL=http
   - KEYSTONE_PUBLIC_SERVICE_HOST=10.18.57.121
   - GLANCE_KEYSTONE_PASSWORD=glance
   - GLANCE_DB_PASSWORD=glance
   - MARIADB_SERVICE_HOST=10.18.57.121
   - KEYSTONE_ADMIN_TOKEN=12345
   - KEYSTONE_ADMIN_SERVICE_HOST=10.18.57.121
   - KEYSTONE_ADMIN_SERVICE_PORT=5000
   - PUBLIC_IP=10.18.57.121
   - DB_ROOT_PASSWORD=kolla
   - GLANCE_API_SERVICE_HOST=10.18.57.121
   - KEYSTONE_ADMIN_PASSWORD=kolla
novaconductor:
  image: imain/fedora-rdo-nova-conductor:latest
  links:
  environment:
   - KEYSTONE_ADMIN_TOKEN=$KEYSTONE_ADMIN_TOKEN
   - KEYSTONE_ADMIN_SERVICE_HOST=$KEYSTONE_ADMIN_SERVICE_HOST
   - NOVA_KEYSTONE_USER=$NOVA_KEYSTONE_USER
   - NOVA_KEYSTONE_PASSWORD=$NOVA_KEYSTONE_PASSWORD
   - NOVA_API_SERVICE_HOST=$NOVA_API_SERVICE_HOST
   - NOVA_EC2_SERVICE_HOST=$NOVA_EC2_SERVICE_HOST
   - ADMIN_TENANT_NAME=$ADMIN_TENANT_NAME
   - PUBLIC_IP=$HOST_IP
   - NOVA_DB_USER=$NOVA_DB_USER
   - NOVA_DB_NAME=$NOVA_DB_NAME
   - NOVA_DB_PASSWORD=$NOVA_DB_PASSWORD
   - RABBIT_USERID=$RABBIT_USER
   - RABBIT_PASSWORD=$RABBIT_PASSWORD
   - RABBITMQ_SERVICE_HOST=$RABBITMQ_SERVICE_HOST
   - KEYSTONE_PUBLIC_SERVICE_HOST=$KEYSTONE_PUBLIC_SERVICE_HOST
   - NETWORK_MANAGER=nova
   - PUBLIC_INTERFACE=$NOVA_PUBLIC_INTERFACE
   - FLAT_INTERFACE=$NOVA_FLAT_INTERFACE
   - MARIADB_SERVICE_HOST=$HOST_IP
   - GLANCE_API_SERVICE_HOST=$GLANCE_API_SERVICE_HOST
   - DB_ROOT_PASSWORD=$MYSQL_ROOT_PASSWORD
novascheduler:
  image: imain/fedora-rdo-nova-scheduler:latest
  links:
  environment:
   - KEYSTONE_ADMIN_TOKEN=$KEYSTONE_ADMIN_TOKEN
   - KEYSTONE_ADMIN_SERVICE_HOST=$KEYSTONE_ADMIN_SERVICE_HOST
   - NOVA_KEYSTONE_USER=$NOVA_KEYSTONE_USER
   - NOVA_KEYSTONE_PASSWORD=$NOVA_KEYSTONE_PASSWORD
   - NOVA_API_SERVICE_HOST=$NOVA_API_SERVICE_HOST
   - NOVA_EC2_SERVICE_HOST=$NOVA_EC2_SERVICE_HOST
   - ADMIN_TENANT_NAME=$ADMIN_TENANT_NAME
   - PUBLIC_IP=$HOST_IP
   - NOVA_DB_USER=$NOVA_DB_USER
   - NOVA_DB_NAME=$NOVA_DB_NAME
   - NOVA_DB_PASSWORD=$NOVA_DB_PASSWORD
   - RABBIT_USERID=$RABBIT_USER
   - RABBIT_PASSWORD=$RABBIT_PASSWORD
   - RABBITMQ_SERVICE_HOST=$RABBITMQ_SERVICE_HOST
   - KEYSTONE_PUBLIC_SERVICE_HOST=$KEYSTONE_PUBLIC_SERVICE_HOST
   - NETWORK_MANAGER=nova
   - PUBLIC_INTERFACE=$NOVA_PUBLIC_INTERFACE
   - FLAT_INTERFACE=$NOVA_FLAT_INTERFACE
   - MARIADB_SERVICE_HOST=$HOST_IP
   - GLANCE_API_SERVICE_HOST=$GLANCE_API_SERVICE_HOST
   - DB_ROOT_PASSWORD=$MYSQL_ROOT_PASSWORD
novaapi:
  image: imain/fedora-rdo-nova-api:latest
  links:
  ports
   - "8774:8774"
  environment:
   - KEYSTONE_ADMIN_TOKEN=$KEYSTONE_ADMIN_TOKEN
   - KEYSTONE_ADMIN_SERVICE_HOST=$KEYSTONE_ADMIN_SERVICE_HOST
   - NOVA_KEYSTONE_USER=$NOVA_KEYSTONE_USER
   - NOVA_KEYSTONE_PASSWORD=$NOVA_KEYSTONE_PASSWORD
   - NOVA_API_SERVICE_HOST=$NOVA_API_SERVICE_HOST
   - NOVA_EC2_SERVICE_HOST=$NOVA_EC2_SERVICE_HOST
   - ADMIN_TENANT_NAME=$ADMIN_TENANT_NAME
   - PUBLIC_IP=$HOST_IP
   - NOVA_DB_USER=$NOVA_DB_USER
   - NOVA_DB_NAME=$NOVA_DB_NAME
   - NOVA_DB_PASSWORD=$NOVA_DB_PASSWORD
   - RABBIT_USERID=$RABBIT_USER
   - RABBIT_PASSWORD=$RABBIT_PASSWORD
   - RABBITMQ_SERVICE_HOST=$RABBITMQ_SERVICE_HOST
   - KEYSTONE_PUBLIC_SERVICE_HOST=$KEYSTONE_PUBLIC_SERVICE_HOST
   - NETWORK_MANAGER=nova
   - PUBLIC_INTERFACE=$NOVA_PUBLIC_INTERFACE
   - FLAT_INTERFACE=$NOVA_FLAT_INTERFACE
   - MARIADB_SERVICE_HOST=$HOST_IP
   - GLANCE_API_SERVICE_HOST=$GLANCE_API_SERVICE_HOST
   - DB_ROOT_PASSWORD=$MYSQL_ROOT_PASSWORD
# Libvirt is in nova compute for now.
######## NOVA ########
#echo Starting libvirt
#docker run -d --privileged -p 16509:16509 \
#       -v /sys/fs/cgroup:/sys/fs/cgroup \
#       -v /var/lib/nova:/var/lib/nova \
#       --pid=host --net=host \
#       kollaglue/fedora-rdo-nova-libvirt
#docker run --name nova-compute -d --privileged \
novacompute:
  image: imain/fedora-rdo-nova-compute:latest
  links:
  privileged: True
  ports:
  volumes::
   - /sys/fs/cgroup:/sys/fs/cgroup
   - /var/lib/nova:/var/lib/nova
   - /run/libvirt:/run/libvirt
   - /etc/libvirt/qemu:/etc/libvirt/qemu
  pid: "host"
  net: "host"
  environment:
   - KEYSTONE_ADMIN_TOKEN=$KEYSTONE_ADMIN_TOKEN
   - KEYSTONE_ADMIN_SERVICE_HOST=$KEYSTONE_ADMIN_SERVICE_HOST
   - NOVA_KEYSTONE_USER=$NOVA_KEYSTONE_USER
   - NOVA_KEYSTONE_PASSWORD=$NOVA_KEYSTONE_PASSWORD
   - NOVA_API_SERVICE_HOST=$NOVA_API_SERVICE_HOST
   - NOVA_EC2_SERVICE_HOST=$NOVA_EC2_SERVICE_HOST
   - ADMIN_TENANT_NAME=$ADMIN_TENANT_NAME
   - PUBLIC_IP=$HOST_IP
   - NOVA_DB_USER=$NOVA_DB_USER
   - NOVA_DB_NAME=$NOVA_DB_NAME
   - NOVA_DB_PASSWORD=$NOVA_DB_PASSWORD
   - RABBIT_USERID=$RABBIT_USER
   - RABBIT_PASSWORD=$RABBIT_PASSWORD
   - RABBITMQ_SERVICE_HOST=$RABBITMQ_SERVICE_HOST
   - KEYSTONE_PUBLIC_SERVICE_HOST=$KEYSTONE_PUBLIC_SERVICE_HOST
   - NETWORK_MANAGER=nova
   - PUBLIC_INTERFACE=$NOVA_PUBLIC_INTERFACE
   - FLAT_INTERFACE=$NOVA_FLAT_INTERFACE
   - MARIADB_SERVICE_HOST=$HOST_IP
   - GLANCE_API_SERVICE_HOST=$GLANCE_API_SERVICE_HOST
   - DB_ROOT_PASSWORD=$MYSQL_ROOT_PASSWORD
novanetwork:
  image: imain/fedora-rdo-nova-network:latest
  links:
  privileged: True
  net: "host"
  ports
  environment:
   - KEYSTONE_ADMIN_TOKEN=$KEYSTONE_ADMIN_TOKEN
   - KEYSTONE_ADMIN_SERVICE_HOST=$KEYSTONE_ADMIN_SERVICE_HOST
   - NOVA_KEYSTONE_USER=$NOVA_KEYSTONE_USER
   - NOVA_KEYSTONE_PASSWORD=$NOVA_KEYSTONE_PASSWORD
   - NOVA_API_SERVICE_HOST=$NOVA_API_SERVICE_HOST
   - NOVA_EC2_SERVICE_HOST=$NOVA_EC2_SERVICE_HOST
   - ADMIN_TENANT_NAME=$ADMIN_TENANT_NAME
   - PUBLIC_IP=$HOST_IP
   - NOVA_DB_USER=$NOVA_DB_USER
   - NOVA_DB_NAME=$NOVA_DB_NAME
   - NOVA_DB_PASSWORD=$NOVA_DB_PASSWORD
   - RABBIT_USERID=$RABBIT_USER
   - RABBIT_PASSWORD=$RABBIT_PASSWORD
   - RABBITMQ_SERVICE_HOST=$RABBITMQ_SERVICE_HOST
   - KEYSTONE_PUBLIC_SERVICE_HOST=$KEYSTONE_PUBLIC_SERVICE_HOST
   - NETWORK_MANAGER=nova
   - PUBLIC_INTERFACE=$NOVA_PUBLIC_INTERFACE
   - FLAT_INTERFACE=$NOVA_FLAT_INTERFACE
   - MARIADB_SERVICE_HOST=$HOST_IP
   - GLANCE_API_SERVICE_HOST=$GLANCE_API_SERVICE_HOST
   - DB_ROOT_PASSWORD=$MYSQL_ROOT_PASSWORD
   - CONFIG_NETWORK=$CONFIG_NETWORK
